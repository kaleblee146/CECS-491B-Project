files:
  "/opt/elasticbeanstalk/hooks/appdeploy/post/99_check_database.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      
      # Allow time for application startup
      sleep 10
      
      # Test database connection using the dbtest endpoint
      curl -s http://localhost:8000/dbtest/ | grep "DB OK"
      
      if [ $? -eq 0 ]; then
        echo "Database connection successful!"
      else
        echo "Database connection failed. Please check your settings."
      fi